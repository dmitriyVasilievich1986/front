/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkreact_front"] = self["webpackChunkreact_front"] || []).push([["src_layouts_blog_BlogWriter_js"],{

/***/ "./src/layouts/blog/BlogWriter.js":
/*!****************************************!*\
  !*** ./src/layouts/blog/BlogWriter.js ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\n/* harmony import */ var _Error404__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../Error404 */ \"./src/Error404.js\");\n/* harmony import */ var react_redux__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-redux */ \"./node_modules/react-redux/es/index.js\");\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! axios */ \"./node_modules/axios/index.js\");\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _common_getHeaders__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/getHeaders */ \"./src/common/getHeaders.js\");\n/* harmony import */ var _ckeditor_ckeditor5_react__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @ckeditor/ckeditor5-react */ \"./node_modules/@ckeditor/ckeditor5-react/dist/ckeditor.js\");\n/* harmony import */ var _ckeditor_ckeditor5_react__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_ckeditor_ckeditor5_react__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var _ckeditor_ckeditor5_build_classic__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @ckeditor/ckeditor5-build-classic */ \"./node_modules/@ckeditor/ckeditor5-build-classic/build/ckeditor.js\");\n/* harmony import */ var _ckeditor_ckeditor5_build_classic__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_ckeditor_ckeditor5_build_classic__WEBPACK_IMPORTED_MODULE_6__);\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\n\n\n\n\n\n\n\n\nfunction BlogWriter(props) {\n  var _React$useState = react__WEBPACK_IMPORTED_MODULE_0__.useState(\"new blog\"),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      text = _React$useState2[0],\n      updateText = _React$useState2[1];\n\n  var _React$useState3 = react__WEBPACK_IMPORTED_MODULE_0__.useState(true),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      first = _React$useState4[0],\n      updateFirst = _React$useState4[1];\n\n  var _React$useState5 = react__WEBPACK_IMPORTED_MODULE_0__.useState(\"new\"),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      blogName = _React$useState6[0],\n      updateBlogName = _React$useState6[1];\n\n  var _React$useState7 = react__WEBPACK_IMPORTED_MODULE_0__.useState([]),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      blogs = _React$useState8[0],\n      updateBlogs = _React$useState8[1];\n\n  var _React$useState9 = react__WEBPACK_IMPORTED_MODULE_0__.useState([]),\n      _React$useState10 = _slicedToArray(_React$useState9, 2),\n      catalogs = _React$useState10[0],\n      updateCatalogs = _React$useState10[1];\n\n  var _React$useState11 = react__WEBPACK_IMPORTED_MODULE_0__.useState(\"\"),\n      _React$useState12 = _slicedToArray(_React$useState11, 2),\n      catalog = _React$useState12[0],\n      updateCatalog = _React$useState12[1];\n\n  var _React$useState13 = react__WEBPACK_IMPORTED_MODULE_0__.useState({}),\n      _React$useState14 = _slicedToArray(_React$useState13, 2),\n      blogData = _React$useState14[0],\n      updateBlogData = _React$useState14[1];\n\n  var _React$useState15 = react__WEBPACK_IMPORTED_MODULE_0__.useState(null),\n      _React$useState16 = _slicedToArray(_React$useState15, 2),\n      blogID = _React$useState16[0],\n      updateblogID = _React$useState16[1];\n\n  var _React$useState17 = react__WEBPACK_IMPORTED_MODULE_0__.useState(\"new\"),\n      _React$useState18 = _slicedToArray(_React$useState17, 2),\n      newBlogName = _React$useState18[0],\n      updateNewBlogName = _React$useState18[1];\n\n  var _React$useState19 = react__WEBPACK_IMPORTED_MODULE_0__.useState(\"new\"),\n      _React$useState20 = _slicedToArray(_React$useState19, 2),\n      blogTitle = _React$useState20[0],\n      updateBlogTitle = _React$useState20[1];\n\n  react__WEBPACK_IMPORTED_MODULE_0__.useEffect(function (_) {\n    var _props$fullCatalog;\n\n    ((_props$fullCatalog = props.fullCatalog) === null || _props$fullCatalog === void 0 ? void 0 : _props$fullCatalog.child) && updateBlogName(props.fullCatalog.child[0].name);\n    axios__WEBPACK_IMPORTED_MODULE_3___default().get('/api/catalog/').then(function (data) {\n      // console.log(data.data)\n      var cs = data.data;\n      updateCatalogs(data.data);\n      axios__WEBPACK_IMPORTED_MODULE_3___default().get('/api/blog/').then(function (data) {\n        updateBlogs([].concat(_toConsumableArray(data.data), [{\n          name: \"new\",\n          title: \"new\",\n          text: \"new blog\",\n          id: null\n        }])); // console.log(data.data)\n        // data.data[0] && updateBlogName(data.data[0].name)\n\n        var c = cs.filter(function (a) {\n          return a.id == data.data[0].catalog;\n        })[0];\n        updateCatalog(c.name); // updateText(data.data[0].text)\n        // updateBlogName(data.data[0].name)\n        // updateNewBlogName(data.data[0].name)\n        // updateBlogTitle(data.data[0].title)\n        // updateblogID(data.data[0].id)\n      })[\"catch\"](function (err) {\n        return console.log(err.message);\n      });\n    })[\"catch\"](function (err) {\n      return console.log(err.message);\n    });\n  }, [first]);\n\n  var getBlogText = function getBlogText(name) {\n    if (name == \"new\") {\n      updateText(\"new blog\");\n      updateBlogName(\"new\");\n      updateNewBlogName(\"new\");\n      updateBlogTitle(\"new\");\n      updateblogID(null);\n      return;\n    } // console.log(name)\n\n\n    updateBlogName(name);\n    updateNewBlogName(name);\n    axios__WEBPACK_IMPORTED_MODULE_3___default().get(\"/api/blog/\".concat(name, \"/by_name/\")).then(function (data) {\n      updateText(data.data.text);\n      updateblogID(data.data.id);\n      updateBlogTitle(data.data.title);\n    })[\"catch\"](function (err) {\n      return console.log(err);\n    });\n  };\n\n  var saveBlogHandler = function saveBlogHandler(_) {\n    if (newBlogName == blogName && blogID !== null) {\n      sendUpdateBlogData();\n    } else {\n      console.log(\"new blog\");\n      sendNewBlog();\n    }\n  };\n\n  var sendNewBlog = function sendNewBlog(_) {\n    var c = catalogs.filter(function (a) {\n      return a.name == catalog;\n    })[0].id;\n    var context = {\n      name: newBlogName,\n      title: blogTitle,\n      text: text,\n      catalog: c\n    };\n    axios__WEBPACK_IMPORTED_MODULE_3___default().post(\"/api/blog/\", context, (0,_common_getHeaders__WEBPACK_IMPORTED_MODULE_4__.default)()).then(function (data) {\n      updateBlogs([].concat(_toConsumableArray(blogs), [data.data]));\n      updateText(data.data.text);\n      updateBlogTitle(data.data.title);\n      updateBlogName(data.data.name);\n      updateNewBlogName(data.data.name);\n    })[\"catch\"](function (err) {\n      return console.log(err.message);\n    });\n  };\n\n  var sendUpdateBlogData = function sendUpdateBlogData(_) {\n    var c = catalogs.filter(function (a) {\n      return a.name == catalog;\n    })[0].id; // console.log(text)\n\n    var context = {\n      title: blogTitle,\n      text: text,\n      catalog: c\n    };\n    axios__WEBPACK_IMPORTED_MODULE_3___default().patch(\"/api/blog/\".concat(blogID, \"/\"), context, (0,_common_getHeaders__WEBPACK_IMPORTED_MODULE_4__.default)()).then(function (data) {\n      updateText(data.data.text);\n      updateBlogTitle(data.data.title);\n    })[\"catch\"](function (err) {\n      return console.log(err.message);\n    });\n  };\n\n  if (props.user && props.user.is_superuser) return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"div\", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"div\", {\n    className: \"row\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"p\", {\n    className: \"mr1\"\n  }, \"blog name:\"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"select\", {\n    style: {\n      width: \"250px\"\n    },\n    value: blogName,\n    onChange: function onChange(e) {\n      return getBlogText(e.target.value);\n    }\n  }, blogs.map(function (c) {\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"option\", {\n      value: c.name,\n      key: c.name\n    }, c.title);\n  }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"div\", {\n    className: \"row\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"p\", {\n    className: \"mr1\"\n  }, \"blog name:\"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"select\", {\n    style: {\n      width: \"250px\"\n    },\n    value: catalog,\n    onChange: function onChange(e) {\n      return updateCatalog(e.target.value);\n    }\n  }, catalogs.map(function (c) {\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"option\", {\n      value: c.name,\n      key: c.name\n    }, c.name);\n  }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"input\", {\n    type: \"text\",\n    value: newBlogName,\n    onChange: function onChange(e) {\n      return updateNewBlogName(e.target.value);\n    }\n  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"input\", {\n    type: \"text\",\n    value: blogTitle,\n    onChange: function onChange(e) {\n      return updateBlogTitle(e.target.value);\n    }\n  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"button\", {\n    className: \"btn btn-blue\",\n    onClick: saveBlogHandler\n  }, newBlogName == blogName && blogID != null ? \"Save\" : \"New\"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ckeditor_ckeditor5_react__WEBPACK_IMPORTED_MODULE_5__.CKEditor, {\n    editor: (_ckeditor_ckeditor5_build_classic__WEBPACK_IMPORTED_MODULE_6___default()),\n    data: text,\n    onChange: function onChange(event, editor) {\n      var data = editor.getData();\n      updateText(data); // console.log({ event, editor, data });\n    }\n  })) // <div className='row'>\n  //     <div className='col1' />\n  //     <div className='col3'>\n  //         <div className=\"row\">\n  //             <p className=\"mr1\">blog name:</p>\n  //             <select\n  //                 value={blogName}\n  //                 onChange={e => getBlogText(e.target.value)}\n  //             >\n  //                 {blogs.map(c => <option value={c.name} key={c.name}>{c.title}</option>)}\n  //             </select>\n  //         </div>\n  //         <button onClick={sendUpdateBlogData}>Save</button>\n  //         <textarea style={{ width: \"100%\" }} className=\"mt3 mb3\" value={text} onChange={e => updateText(e.target.value)} />\n  //         <div dangerouslySetInnerHTML={{ __html: text }} />\n  //     </div>\n  //     <div className='col1' />\n  // </div>\n  ;\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Error404__WEBPACK_IMPORTED_MODULE_1__.default, null);\n}\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    fullCatalog: state.main.fullCatalog,\n    token: state.main.token,\n    user: state.main.user\n  };\n};\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,react_redux__WEBPACK_IMPORTED_MODULE_2__.connect)(mapStateToProps, null)(BlogWriter));\n\n//# sourceURL=webpack://react-front/./src/layouts/blog/BlogWriter.js?");

/***/ })

}]);